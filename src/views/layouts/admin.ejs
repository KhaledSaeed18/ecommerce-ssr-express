<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        <%= title %> | SSR Store
    </title>
    <link rel="stylesheet" href="/css/style.css">
    <script src="/lucide/lucide.min.js" defer></script>
</head>

<body>
    <nav class="navbar navbar-admin">
        <div class="navbar-container">
            <div class="flex items-center gap-md">
                <a href="/" class="navbar-brand">
                    <i data-lucide="store" style="width: 24px; height: 24px;"></i>
                    SSR Store
                </a>
                <span class="badge badge-danger">ADMIN</span>
            </div>
            <div class="navbar-nav">
                <span class="navbar-user">Welcome, <%= user.email %></span>
                <form action="/auth/logout" method="POST" style="display: inline;">
                    <input type="hidden" name="_csrf" value="<%= csrfToken %>">
                    <button type="submit" class="navbar-btn">Logout</button>
                </form>
            </div>
        </div>
    </nav>

    <div class="dashboard-layout">
        <aside class="dashboard-sidebar">
            <div class="sidebar-section">
                <h3 class="sidebar-section-title">Dashboard</h3>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item">
                        <a href="/admin/dashboard"
                            class="sidebar-nav-link <%= (typeof currentPage !== 'undefined' && currentPage === 'dashboard') ? 'active' : '' %>">
                            <i data-lucide="layout-dashboard"></i>
                            Overview
                        </a>
                    </li>
                </ul>
            </div>

            <div class="sidebar-section">
                <h3 class="sidebar-section-title">Management</h3>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item">
                        <a href="/admin/products"
                            class="sidebar-nav-link <%= (typeof currentPage !== 'undefined' && currentPage === 'products') ? 'active' : '' %>">
                            <i data-lucide="package"></i>
                            Products
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="/admin/categories"
                            class="sidebar-nav-link <%= (typeof currentPage !== 'undefined' && currentPage === 'categories') ? 'active' : '' %>">
                            <i data-lucide="folder"></i>
                            Categories
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="/admin/contacts"
                            class="sidebar-nav-link <%= (typeof currentPage !== 'undefined' && currentPage === 'contacts') ? 'active' : '' %>">
                            <i data-lucide="mail"></i>
                            Messages
                            <% if (typeof unreadMessages !=='undefined' && unreadMessages> 0) { %>
                                <span class="badge badge-danger" style="margin-left: var(--spacing-xs);">
                                    <%= unreadMessages %>
                                </span>
                                <% } %>
                        </a>
                    </li>
                </ul>
            </div>

            <div class="sidebar-section">
                <h3 class="sidebar-section-title">Store</h3>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item">
                        <a href="/products" class="sidebar-nav-link">
                            <i data-lucide="store"></i>
                            View Store
                        </a>
                    </li>
                </ul>
            </div>

            <div class="sidebar-section">
                <h3 class="sidebar-section-title">Account</h3>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item">
                        <a href="/account/security"
                            class="sidebar-nav-link <%= (typeof currentPage !== 'undefined' && currentPage === 'security') ? 'active' : '' %>">
                            <i data-lucide="shield"></i>
                            Security
                        </a>
                    </li>
                </ul>
            </div>
        </aside>

        <main class="dashboard-content">
            <%- body %>
        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            lucide.createIcons();
        });
    </script>
</body>

</html>